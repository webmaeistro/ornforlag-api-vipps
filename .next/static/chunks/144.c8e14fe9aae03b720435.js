(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[144],{6301:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return p}});var t=r(266),o=r(809),a=r.n(o),u=r(7294),c=r(4298),i=r(3475),d=r(7384),l=r(5617),s=r(5893);function p(n){var e=n.checkoutModel,r=n.onSuccess,o=(0,d.K)().total,p=(0,u.useState)(null),v=p[0],f=p[1],y=(0,u.useState)("not-started"),h=y[0],k=y[1];return(0,u.useEffect)((function(){!function(){var n=(0,t.Z)(a().mark((function n(){var e,r,t,o,u;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.Z)({query:"\n          query {\n            paymentProviders {\n              paypal {\n                config\n              }\n            }\n          }\n        "});case 2:o=n.sent,(u=null===o||void 0===o||null===(e=o.data)||void 0===e||null===(r=e.paymentProviders)||void 0===r||null===(t=r.paypal)||void 0===t?void 0:t.config)?f(u):k("failed #0");case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()()}),[]),(0,s.jsx)(s.Fragment,{children:h.startsWith("failed")?(0,s.jsxs)("div",{children:["Something went wrong with the payment (",h,")."," ",(0,s.jsx)(l.zx,{onClick:function(){return location.reload()},children:"Try again"})]}):(0,s.jsxs)(s.Fragment,{children:[(null===v||void 0===v?void 0:v.clientId)&&(null===o||void 0===o?void 0:o.currency)&&(0,s.jsx)(c.default,{src:"https://www.paypal.com/sdk/js?client-id=".concat(v.clientId,"&currency=").concat(o.currency.toUpperCase()),onLoad:function(){if(!window.paypal)return console.log("window.paypal not available"),void k("failed #1");window.paypal.Buttons({createOrder:function(){var n=(0,t.Z)(a().mark((function n(){var r,t,o,u,c;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,i.Z)({query:"\n              mutation paypal($checkoutModel: CheckoutModelInput!) {\n                paymentProviders {\n                  paypal {\n                    createPayment(checkoutModel: $checkoutModel) {\n                      success\n                      orderId\n                    }\n                  }\n                }\n              }\n            ",variables:{checkoutModel:e}});case 2:if(u=n.sent,null!==(c=(null===u||void 0===u||null===(r=u.data)||void 0===r||null===(t=r.paymentProviders)||void 0===t||null===(o=t.paypal)||void 0===o?void 0:o.createPayment)||{})&&void 0!==c&&c.success){n.next=7;break}return k("failed #2"),n.abrupt("return");case 7:return n.abrupt("return",c.orderId);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),onApprove:function(){var n=(0,t.Z)(a().mark((function n(t){var o,u,c,d,l,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(d=null===t||void 0===t?void 0:t.orderID){n.next=4;break}return k("failed #3"),n.abrupt("return");case 4:return n.next=6,(0,i.Z)({query:"\n              mutation paypal($orderId: String!, $checkoutModel: CheckoutModelInput!) {\n                paymentProviders {\n                  paypal {\n                    confirmPayment(orderId: $orderId, checkoutModel: $checkoutModel){\n                      success\n                      orderId\n                    }\n                  }\n                }\n              }\n             ",variables:{orderId:d,checkoutModel:e}});case 6:l=n.sent,null!==(s=null===l||void 0===l||null===(o=l.data)||void 0===o||null===(u=o.paymentProviders)||void 0===u||null===(c=u.paypal)||void 0===c?void 0:c.confirmPayment)&&void 0!==s&&s.success?(k("succeeded"),r(s.orderId)):k("failed #4");case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}).render("#paypal-button-container")}}),(0,s.jsx)("div",{id:"paypal-button-container"})]})})}},4298:function(n,e,r){n.exports=r(7926)}}]);